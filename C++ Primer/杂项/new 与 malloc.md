## malloc() 的底层实现
malloc() 函数是 C/C++ 标准库中的函数，底层实现是使用系统调用 brk() 或 sbrk() 在进程地址空间中分配一段连续的内存区域。具体来说，brk() 或 sbrk() 会将进程的程序结束位置 (break) 向高地址扩展，以分配新的内存区域。

malloc() 函数的原型如下：

```c++
void *malloc(size_t size);
```
其中，size 表示需要分配的内存大小，返回值是分配的内存区域的起始地址。如果分配失败，返回 NULL。

## new 的底层实现
new 关键字是 C++ 中用于动态分配内存的操作符，其底层实现与 malloc() 相似。不同之处在于，new 还需要调用构造函数对分配的内存进行初始化。对于对象类型，new 会调用构造函数进行对象初始化；对于基本类型，new 会调用构造函数进行零初始化。

new 的语法如下：

```c++
new T;
new T(args...);
```
其中，T 表示需要分配的类型，args... 是可选的构造函数参数。

当调用 new T; 时，会首先调用 operator new(sizeof(T)) 分配内存，然后调用 T::T() 进行对象初始化。

当调用 new T(args...); 时，会首先调用 operator new(sizeof(T)) 分配内存，然后调用 T::T(args...) 进行对象初始化。

对于对象类型，还需要在对象生命周期结束时调用析构函数和释放内存。这可以通过 delete 操作符实现。调用 delete 时，会首先调用析构函数进行清理，然后调用 operator delete() 释放内存。

## malloc() 和 new 的区别

1. malloc() 是 C 语言标准库中的函数，而 new 是 C++ 中的操作符。
2. malloc() 只负责分配内存，而 new 不仅可以分配内存，还可以调用构造函数进行对象初始化。
3. malloc() 返回 void* 类型的指针，需要强制类型转换成需要的类型。而 new 返回指定类型的指针，无需强制类型转换。
4. malloc() 分配的内存空间大小是由调用者指定的，而 new 分配的内存空间大小是由编译器根据类型自动计算的。
5. new 在分配内存时，如果内存不足或者分配失败，会抛出 std::bad_alloc 异常。而 malloc 分配失败时，返回 NULL